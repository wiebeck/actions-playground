name: playground2
on: push
env:
  IMAGE_BASENAME: 'my-app'
jobs:
  experiment:
    runs-on: ubuntu-latest
    steps:
      - name: Dump GitHub context
        env:
          GITHUB_CONTEXT: ${{ toJSON(github) }}
        run: echo "$GITHUB_CONTEXT"
      - name: Dump job context
        env:
          JOB_CONTEXT: ${{ toJSON(job) }}
        run: echo "$JOB_CONTEXT"
      - name: Dump steps context
        env:
          STEPS_CONTEXT: ${{ toJSON(steps) }}
        run: echo "$STEPS_CONTEXT"
      - name: Dump runner context
        env:
          RUNNER_CONTEXT: ${{ toJSON(runner) }}
        run: echo "$RUNNER_CONTEXT"
      - name: Dump strategy context
        env:
          STRATEGY_CONTEXT: ${{ toJSON(strategy) }}
        run: echo "$STRATEGY_CONTEXT"
      - name: Dump matrix context
        env:
          MATRIX_CONTEXT: ${{ toJSON(matrix) }}
        run: echo "$MATRIX_CONTEXT"

      # This action determines the container image tags for this build
      - name: Docker Metadata
        id: docker_meta
        uses: crazy-max/ghaction-docker-meta@v1
        with:
          images: foo/${{ env.IMAGE_BASENAME }}
          tag-sha: true
          tag-edge: true
          tag-custom: -${{ github.run_number }}
          tag-semver: |
            {{version}}
            {{major}}.{{minor}}
            {{major}}
      # - name: append master version
      #   id: alltags
      #   if: github.ref == "refs/heads/${{ github.event.repository.default_branch }}"
      #   run: echo "::set-output name=tags::${{ steps.docker_meta.outputs.tags }},${{ env.IMAGE_BASENAME }}-${{ github.run_number }}"
